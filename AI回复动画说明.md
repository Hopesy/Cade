# AI 回复动画效果说明

## 🎬 完整的动画流程

### 阶段 1：用户输入
```
>> 用户的问题内容  ← 绿色箭头 + 粗体白色文本
```

### 阶段 2：思考中
```
（底部状态栏显示）
[[===]] 正在思考... (0.5s)  ← 旋转动画，每 100ms 更新
```

### 阶段 3：收到回复
```
（AI 返回回复后）
  ↓
思考动画停止
  ↓
   回复总结  ← Gemini 风格脉动动画开始
```

### 阶段 4：回复动画（1.5秒）- Gemini 风格脉动效果
```
帧 1（0ms）:      回复总结  (空，无点)
帧 2（150ms）: ·  回复总结  (1个点)
帧 3（300ms）: :  回复总结  (2个点)
帧 4（450ms）: ⋮  回复总结  (3个点 - 最亮)
帧 5（600ms）: :  回复总结  (2个点)
帧 6（750ms）: ·  回复总结  (1个点)
帧 7（900ms）:    回复总结  (空，无点)
...（循环直到 1500ms）
```

### 阶段 5：完整回复
```
⋮  回复总结  ← 动画停止，固定显示3个点

AI 的完整回复内容（Markdown 渲染）
支持：
- **粗体**
- *斜体*
- `代码`
- ```代码块```
- # 标题
- 列表
- 链接
...
```

## 🎨 动画细节

### 思考动画（底部状态栏）
- **帧序列**: `[[   ]]` → `[[=  ]]` → `[[== ]]` → `[[===]]` → `[[ ==]]` → `[[  =]]`
- **更新频率**: 100ms
- **位置**: 屏幕底部倒数第二行
- **触发**: `SetProcessing(true, "正在思考...")`
- **停止**: `SetProcessing(false)`

### 回复动画（历史区域）- Gemini 风格
- **帧序列**: ` ` → `·` → `:` → `⋮` → `:` → `·` → ` ` （脉动循环）
- **更新频率**: 150ms（流畅的脉动感）
- **位置**: 历史消息区域（回复头部）
- **颜色**: 橙色 (#D97757)
- **持续时间**: 1.5 秒
- **效果**: 从无到有，从有到无的"呼吸"效果
- **触发**: `ShowResponseHeader(summary)`
- **停止**: `ShowResponse(content)` 自动停止

### 回复总结提取
从 AI 回复中自动提取：
1. 移除所有 Markdown 标记（代码块、粗体、斜体等）
2. 提取第一句话（以句号、问号、感叹号结尾）
3. 如果没有明显的句子，取第一行
4. 限制长度为 60 个字符
5. 超出部分显示 "..."

## 📊 完整示例

### 用户输入
```
➜ 帮我创建一个读取文件的工具
```

### 思考阶段（底部）
```
[[===]] 正在思考... (1.2s)
```

### 工具调用（如果有）
```
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ 🔨 read_file ({"FilePath":"test.txt"}) ┃
┣━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┫
┃ 文件内容已读取...              ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
```

### 回复动画阶段（Gemini 风格脉动）
```
   我已经帮你创建了一个读取文件的工具  (空)
  ↓ (150ms)
·  我已经帮你创建了一个读取文件的工具  (1个点)
  ↓ (150ms)
:  我已经帮你创建了一个读取文件的工具  (2个点)
  ↓ (150ms)
⋮  我已经帮你创建了一个读取文件的工具  (3个点 - 最亮)
  ↓ (150ms)
:  我已经帮你创建了一个读取文件的工具  (2个点)
  ↓ (150ms)
·  我已经帮你创建了一个读取文件的工具  (1个点)
  ↓ (150ms)
   我已经帮你创建了一个读取文件的工具  (空)
  ↓ ...（循环 1.5 秒）
```

### 完整回复
```
⋮  我已经帮你创建了一个读取文件的工具

我已经帮你创建了一个读取文件的工具，具体实现如下：

# ReadFileTool 类

这个工具可以：
• 读取指定路径的文件
• 验证文件是否存在
• 返回文件内容

使用示例：
    var result = await tool.ExecuteAsync(
        "{\"FilePath\":\"test.txt\"}"
    );
```

## 🎯 与 Gemini 的对比

### Gemini 动画特点
- **脉动效果**: 点从无到有，再从有到无
- **竖向排列**: 三个点垂直排列
- **流畅感**: 快速的脉动（约 150ms 一帧）
- **呼吸感**: 像呼吸灯一样的节奏感

### 我们的实现
✅ **脉动效果**: `空 → · → : → ⋮ → : → · → 空`
✅ **竖向排列**: 使用 `·` (1点), `:` (2点), `⋮` (3点)
✅ **流畅感**: 150ms 更新频率
✅ **呼吸感**: 完整的从无到有再到无的循环

## 🔧 代码位置

- **动画帧定义**: `ConsoleUserInterface.cs:24-33`
- **动画更新逻辑**: `ConsoleUserInterface.cs:88-125`
- **回复头部显示**: `ConsoleUserInterface.cs:304-321`
- **完整回复显示**: `ConsoleUserInterface.cs:323-335`
- **用户输入显示**: `ConsoleUserInterface.cs:206-215`
- **总结提取逻辑**: `CadeHostedService.cs:174-206`
- **流程控制**: `CadeHostedService.cs:135-172`
