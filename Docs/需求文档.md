# 需求文档

> 本文档记录 Cade 项目的功能需求、优先级和验收标准

---

## 📋 需求列表

### 核心功能需求

- [ ] REQ-001: 多 AI Provider 支持
  - 优先级: 高
  - 状态: 已完成
  - 描述: 支持 OpenAI、Azure OpenAI、Anthropic Claude 等多个 AI Provider
  - 验收标准:
    - [x] 支持从 settings.json 加载多个 Provider 配置
    - [x] 支持运行时切换模型
    - [x] 配置文件存储在 ~/.cade/settings.json

- [ ] REQ-002: 内置工具插件系统
  - 优先级: 高
  - 状态: 已完成
  - 描述: 提供文件系统操作和系统命令执行工具
  - 验收标准:
    - [x] FileSystemPlugin (读写文件、搜索、Grep 等)
    - [x] SystemPlugin (执行 Shell 命令、获取系统信息)
    - [x] AI 可自动调用工具

- [ ] REQ-003: MCP 协议支持
  - 优先级: 高
  - 状态: 已完成
  - 描述: 完整支持 Model Context Protocol，可集成第三方 MCP Servers
  - 验收标准:
    - [x] McpBridge 自动连接 MCP Server
    - [x] 将 MCP 工具转换为 Semantic Kernel 插件
    - [x] 支持从 settings.json 配置多个 MCP Servers

- [ ] REQ-004: 终端 UI 优化
  - 优先级: 中
  - 状态: 已完成
  - 描述: 提供友好的终端用户界面
  - 验收标准:
    - [x] Markdown 渲染（代码高亮、列表、表格）
    - [x] 实时状态栏（路径、模型、思考动画）
    - [x] 对话历史滚动显示
    - [x] 支持 ESC 键取消任务

---

## 🚀 待开发需求

- [ ] REQ-005: 对话历史持久化
  - 优先级: 中
  - 预计时间: 2天
  - 状态: 待开发
  - 描述: 将对话历史保存到本地，支持会话恢复
  - 验收标准:
    - [ ] 对话历史存储为 JSON 文件
    - [ ] 支持查看历史会话列表
    - [ ] 支持恢复历史会话继续对话

- [ ] REQ-006: 流式响应支持
  - 优先级: 中
  - 预计时间: 3天
  - 状态: 待开发
  - 描述: 支持 AI 回复的流式输出，提升交互体验
  - 验收标准:
    - [ ] 实时显示 AI 生成的文本
    - [ ] 支持工具调用时的流式显示
    - [ ] 不影响 Markdown 渲染质量

- [ ] REQ-007: 配置管理命令
  - 优先级: 低
  - 预计时间: 2天
  - 状态: 待开发
  - 描述: 提供命令行配置管理功能
  - 验收标准:
    - [ ] /config list - 列出所有配置
    - [ ] /config set <key> <value> - 设置配置
    - [ ] /config provider add - 添加新 Provider

- [ ] REQ-008: 单元测试覆盖
  - 优先级: 中
  - 预计时间: 5天
  - 状态: 待开发
  - 描述: 为核心模块添加单元测试
  - 验收标准:
    - [ ] ProviderService 测试覆盖率 > 80%
    - [ ] FileSystemPlugin 测试覆盖率 > 80%
    - [ ] McpBridge 测试覆盖率 > 80%

---

## 📝 需求变更记录

| 日期 | 需求编号 | 变更类型 | 说明 |
|------|---------|---------|------|
| 2025-01-14 | REQ-001 | 新增 | 初始需求文档创建 |

---

## 📌 备注

- 优先级定义:
  - **高**: 核心功能，必须实现
  - **中**: 重要功能，计划实现
  - **低**: 增强功能，可延后实现

- 状态定义:
  - **已完成**: 功能已实现并通过验收
  - **进行中**: 正在开发中
  - **待开发**: 已规划但未开始
  - **已搁置**: 暂时不实现
